---
layout: default
title: aws-cli
parent: cheatsheets
nav_order: 9
---
# aws-cli cheatsheet
{: .no_toc }

## Table of contents
{: .no_toc .text-delta }

1. TOC
{:toc}

---

## Installation
You can install the AWS CLI on various platforms such as Windows, macOS, and Linux. Refer to the official AWS CLI 
documentation for detailed instructions on how to install the CLI on your platform.

### On macOS    

By following these steps, you can install the AWS CLI on macOS using Homebrew. This is a simple and convenient 
way to install the AWS CLI, and it ensures that you have the latest version of the CLI and its dependencies.

**Step 1: Install Homebrew**    
If you don't have Homebrew installed, you can install it by running the following command in your terminal:
````bash
$ /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
````
This command will download and run the Homebrew installation script.

**Step 2: Install the AWS CLI**     
Once Homebrew is installed, you can install the AWS CLI by running the following command:

```bash
$ brew install awscli
```
This command will download and install the AWS CLI and its dependencies.

**Step 3: Verify the installation**     
After the installation is complete, you can verify that the AWS CLI is installed by running the following command:

```bash
$ aws --version
```
This command should output the version number of the AWS CLI that you just installed.

## Configuration
After installing the AWS CLI, you need to configure it to access your AWS resources. The configuration process 
involves creating an IAM user, generating an access key and secret access key, and configuring the CLI with the 
access keys.

You can configure the AWS CLI by using the **aws configure** command. The command prompts you to enter your 
AWS access key ID, secret access key, default region, and default output format.

You can configure additional profiles by using aws configure with the --profile option, or by manually adding 
entries to the config and credentials files. For more information on the config and credentials files, see 
[Configuration and credential file settings](https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-files.html)

Examples:

```shell
$ aws configure
```

```shell
$ aws configure --profile profile1
```

For example, the files generated by the AWS CLI for a default profile configured with aws configure looks similar 
to the following.

~/.aws/credentials
```makefile
[default]
aws_access_key_id=AKIAIOSFODNN7EXAMPLE
aws_secret_access_key=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY
```

~/.aws/config
```makefile
[default]
region=us-west-2
output=json
```

### Working with multiple AWS profiles
Working with multiple AWS profiles is a common scenario for many AWS users, especially those who have multiple AWS 
accounts or IAM roles to access different resources. The AWS CLI allows you to easily switch between different 
profiles without having to reconfigure the CLI every time.      

Here are the steps to work with several and different AWS profiles:     

**Step 1: Create multiple profiles**

You can create multiple profiles in your AWS credentials file. The default location of this file is ~/.aws/credentials 
on Linux, macOS, or Unix, and %USERPROFILE%\.aws\credentials on Windows.

You can create a new profile by adding a new section to the credentials file with the profile name in square brackets 
([]), followed by the AWS access key ID and secret access key:

```makefile
[profile1]
aws_access_key_id = <access-key-id>
aws_secret_access_key = <secret-access-key>

[profile2]
aws_access_key_id = <access-key-id>
aws_secret_access_key = <secret-access-key>
```

also you can add or create a new profile executing the following command line:

```bash
$ aws configure --profile profile1
```

You can also include other options such as the default region and output format for each profile.

**Step 2: Configure the AWS CLI to use profiles**   

Once you have created multiple profiles, you can configure the AWS CLI to use them. You can set the AWS_PROFILE 
environment variable to specify which profile to use. For example:

```bash
$ export AWS_PROFILE=profile1
```

This sets the AWS_PROFILE environment variable to profile1, which tells the AWS CLI to use the credentials for 
that profile.

Alternatively, you can specify the profile name in the CLI command itself by using the --profile option:

```bash
$ aws ec2 describe-instances --profile profile1
```

This tells the aws command to use the profile1 profile for the ec2 describe-instances command.

**Step 3: Switch between profiles**     

You can switch between profiles by changing the AWS_PROFILE environment variable or by specifying a different profile
name in the --profile option.

For example, to switch from profile1 to profile2, you can use the following command:

```shell
$ export AWS_PROFILE=profile2
```

Or, you can use the --profile option with the aws command:

```shell
$ aws ec2 describe-instances --profile profile2
```

## Getting information about the AWS account associated with a specific profile
To get information about the AWS account associated with a specific profile, you can use the AWS CLI command aws 
sts get-caller-identity with the --profile option.

Here are the steps to get information about the AWS account associated with a specific profile:

**Step 1: Set the profile**     

First, set the AWS_PROFILE environment variable to the name of the profile you want to use. For example, to use a 
profile named "myprofile", you can run:

```shell
$ export AWS_PROFILE=myprofile
```

**Step 2: Run the aws sts get-caller-identity command**     

Next, run the aws sts get-caller-identity command with the --profile option. This command retrieves information about 
the AWS account associated with the specified profile.

```shell
$ aws sts get-caller-identity --profile myprofile
```

The output of this command includes the AWS account ID, the IAM user or role name, and the Amazon Resource Name (ARN) of the user or role.

For example:

```json
{
    "Account": "123456789012",
    "UserId": "ABCDEFGHIJKLMNOPQRSTU:myuser",
    "Arn": "arn:aws:iam::123456789012:user/myuser"
}
```

## Test 5
## Test 6
